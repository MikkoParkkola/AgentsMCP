<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Models</title>
    <style>
      body { font-family: system-ui, sans-serif; margin: 1.5rem; }
      .row { display:flex; gap:1rem; }
      .col { flex:1; border:1px solid #ddd; padding:1rem; border-radius:8px; }
      label { display:block; font-weight:600; margin-top:0.5rem; }
      input { padding:6px; width: 240px; }
      ul { list-style: none; padding: 0; }
      li { padding: 2px 0; }
      .banner { padding:8px 12px; border-radius:6px; margin-bottom: 10px; display:none; }
      .banner.err { background:#ffe6e6; color:#933; border:1px solid #f2c1c1; }
    </style>
  </head>
  <body>
    <h1>Models</h1>
    <div class="banner err" id="banner"></div>
    <div>
      <label>Provider</label>
      <input id="provider" value="openai" />
      <button id="load">Load</button>
      <a href="/ui/">Back to Dashboard</a>
    </div>
    <div class="row" style="margin-top:1rem">
      <div class="col">
        <h3>Available Models</h3>
        <ul id="models"></ul>
      </div>
    </div>

    <script>
      const banner = document.getElementById('banner');
      function showErr(msg){ banner.style.display='block'; banner.textContent=msg; }
      function clearErr(){ banner.style.display='none'; }

      async function load(){
        clearErr();
        const provider = document.getElementById('provider').value.trim();
        if (!provider) return;
        try {
          const r = await fetch('/providers/' + encodeURIComponent(provider) + '/models');
          if (!r.ok) throw new Error(await r.text());
          const j = await r.json();
          const ul = document.getElementById('models');
          ul.innerHTML='';
          (j.models||[]).slice(0,200).forEach(m => {
            const li = document.createElement('li');
            li.textContent = m.id + (m.name && m.name!==m.id ? (' ('+m.name+')') : '');
            ul.appendChild(li);
          });
        } catch (e) { showErr('Failed to load: ' + e); }
      }
      document.getElementById('load').addEventListener('click', load);
      load();
    </script>
  </body>
</html>
